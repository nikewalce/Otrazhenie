# BeautyCycle MVP - TODO List

## 1. Настройка проекта
- [ ] Создать виртуальное окружение (`venv`/`poetry`) и установить зависимости: `Flask`, `psycopg2-binary`, `SQLAlchemy`, `opencv-python`, `pyzbar`, `numpy`.
- [ ] Создать структуру проекта:
``` 
project/
app.py
config.py
analyzers/
templates/
static/
models/
tests/
```
- [ ] Настроить PostgreSQL для проекта (создать базу `beautycycle_mvp`, пользователя, пароль).
- [ ] Настроить подключение через SQLAlchemy (`app.config['SQLALCHEMY_DATABASE_URI'] = ...`).
- [ ] Проверить запуск сервера `flask run`.

## 2. База ингредиентов
- [ ] Создать таблицу `ingredients` в PostgreSQL: `id`, `name`, `function`, `safety_score`, `description`.
- [ ] Сделать скрипт импорта CSV `analyzers/inci_data.csv` в PostgreSQL.
- [ ] Добавить функцию `get_ingredient(name)` для поиска ингредиента по имени.

## 3. Сканер состава
- [ ] Создать страницу `/` с формой загрузки штрих-кода и ручного ввода состава.
- [ ] Реализовать `/handle-scan` для обработки изображений с декодированием штрих-кода через pyzbar.
- [ ] Реализовать `/handle-search` для поиска продукта по названию.
- [ ] Реализовать `/manual-analysis` для ручного ввода состава.

## 4. Анализ ингредиентов
- [ ] Создать таблицы `products` и `product_ingredients`.
- [ ] Функция разбора состава на ингредиенты и вытаскивания данных из БД.
- [ ] Рендер таблицы с колонками: Название, Функция, Оценка безопасности, Описание.
- [ ] Добавить цветовую индикацию (безопасно/умеренно/риск).

## 5. История сканирований (дневник)
- [ ] Создать таблицу `user_products` (`id`, `user_id`, `product_id`, `scanned_at`).
- [ ] Добавлять запись при успешном анализе продукта.
- [ ] Страница `/diary` с историей сканирований.
- [ ] Возможность фильтрации по дате или рейтингу безопасности.

## 6. Базовый подбор продуктов
- [ ] Добавить поле `skin_type` для пользователей.
- [ ] Создать таблицу `product_recommendations` с указанием `skin_type`.
- [ ] Страница `/recommendations` с рекомендациями по типу кожи.
- [ ] Подбор продуктов по минимальному количеству рискованных ингредиентов.

## 7. Рекомендации безопасных аналогов
- [ ] Таблица `partner_products`: `id`, `name`, `brand`, `link`, `ingredients`.
- [ ] Функция подбора аналогов с совпадением ингредиентов ≥70%.
- [ ] Вывод списка с ссылками на магазины.

## 8. Тестирование
- [ ] Юнит-тесты:
- [ ] `decode_barcode`
- [ ] `get_ingredient`
- [ ] `manual_analysis` и парсинг состава
- [ ] Интеграционные тесты:
- [ ] POST формы `/handle-scan`, `/handle-search`, `/manual-analysis`
- [ ] GET страниц `/results`, `/diary`, `/recommendations`
- [ ] Проверка ошибок:
- [ ] Нет файла
- [ ] Пустой состав
- [ ] Продукт не найден

## 9. UI/UX
- [ ] Проверка отображения на разных устройствах (desktop, mobile).
- [ ] Flash-сообщения о статусе.
- [ ] Прогресс анализа и загрузки изображения.

## 10. Продакшн
- [ ] Настроить Gunicorn + Nginx.
- [ ] Перенести БД на удалённый сервер PostgreSQL.
- [ ] Настроить `.env` для секретов и ключей.
- [ ] Логирование ошибок и действий пользователей.
